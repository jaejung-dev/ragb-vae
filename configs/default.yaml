data:
  source: bucket  # bucket or multilayer
  bucket_root: /home/ubuntu/jjseol/lica-data-2/for_jjseol/rgba_dataset
  bucket_split: train
  bucket_val_split: val
  bucket_datasets:
    - type: components
      root: /home/ubuntu/jjseol/lica-data-2/for_jjseol/rgba_dataset/lica_250k
      manifest: /home/ubuntu/jjseol/lica-data-2/for_jjseol/rgba_dataset/lica_250k/metadata/manifest.json
      # train/val 모두 사용
    - type: prism_real
      root: /home/ubuntu/jjseol/lica-data-2/for_jjseol/rgba_dataset/prism_layer_real
      manifest: /home/ubuntu/jjseol/lica-data-2/for_jjseol/rgba_dataset/prism_layer_real/metadata/manifest.json
      split: train
      splits: [train]  # val에는 포함하지 않음
    - type: prism_pro
      root: /home/ubuntu/jjseol/lica-data-2/for_jjseol/rgba_dataset/prism_layer_pro
      manifest: /home/ubuntu/jjseol/lica-data-2/for_jjseol/rgba_dataset/prism_layer_pro/metadata/manifest.json
      split: train
      splits: [train]
      respect_manifest_split: false
      use_fg_non_overlap: true
      use_rep: true
    - type: laion_rgb
      root: /home/ubuntu/jjseol/lica-data-2/for_jjseol/rgba_dataset/laion1M_aethtetic
      split: train
      splits: [train]
  batch_size: 2
  num_workers: 4
  shuffle: true
  background_blend_prob: 0.0
  background_sample_prob: 0.0

training:
  stage: rgba_vae  # options: rgba_vae, decompose, refine
  # placeholders for future hyperparameters
  learning_rate: 1e-4
  epochs: 10
  ckpt_dir: checkpoints
  gradient_accumulation_steps: 1

  mixed_precision: "bf16"  # options: no, fp16, bf16
  log_every: 50
  run_validation: true
  val_every_steps: 500
  val_max_batches: 10
  val_visual_rows: 8
  val_output_dir: outputs/val
  val_background_colors:
    - white
    - black
  ckpt_every_steps: 5000
  max_grad_norm: 1.0

model:
  name: rgba_vae
  base_arch: qwen  # options: qwen, flux
  beta: 0.25
  alpha_loss_weight: 1.0
  alpha_l1_weight: 0.0
  rgb_loss_weight: 1.0
  white_bg_loss_weight: 0.5
  black_bg_loss_weight: 0.5
  rgb_checkpoint: /home/ubuntu/qwen-image-layered/checkpoints/rgba_vae_init
  rgb_subfolder: null  # override if weights are stored under a subfolder
  alpha_bias_init: 0.0
  torch_dtype: float32

